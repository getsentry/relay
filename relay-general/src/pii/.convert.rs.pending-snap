{"run_id":"1683640102-44947000","line":1316,"new":{"module_name":"relay_general__pii__convert__tests","snapshot_name":"breadcrumb_message","metadata":{"source":"relay-general/src/pii/convert.rs","assertion_line":1316,"expression":"pii_config"},"snapshot":"{\n  \"rules\": {\n    \"strip-fields\": {\n      \"type\": \"redact_pair\",\n      \"keyPattern\": \"session_key\",\n      \"redaction\": {\n        \"method\": \"replace\",\n        \"text\": \"[Filtered]\"\n      }\n    }\n  },\n  \"applications\": {\n    \"($string || $number || $array || $object) && !(debug_meta.** || $frame.filename || $frame.abs_path || $logentry.formatted || $error.value)\": [\n      \"@common:filter\",\n      \"@ip:replace\",\n      \"strip-fields\"\n    ],\n    \"$http.env.REMOTE_ADDR || $user.ip_address || $sdk.client_ip\": [\n      \"@anything:remove\"\n    ],\n    \"*.cookies.sentrysid || *.cookies.sudo || *.cookies.su || *.cookies.session || *.cookies.__session || *.cookies.sessionid || *.cookies.user_session || *.cookies.symfony || *.cookies.phpsessid || *.cookies.fasthttpsessionid || *.cookies.mysession || *.cookies.irissessionid || *.cookies.csrf || *.cookies.xsrf || *.cookies._xsrf || *.cookies._csrf || *.cookies.csrf-token || *.cookies.csrf_token || *.cookies.xsrf-token || *.cookies.xsrf_token || *.cookies.fastcsrf || *.cookies._iris_csrf\": [\n      \"@anything:filter\"\n    ]\n  }\n}"},"old":{"module_name":"relay_general__pii__convert__tests","metadata":{},"snapshot":"{\n  \"rules\": {\n    \"strip-fields\": {\n      \"type\": \"redact_pair\",\n      \"keyPattern\": \"session_key\",\n      \"redaction\": {\n        \"method\": \"replace\",\n        \"text\": \"[Filtered]\"\n      }\n    }\n  },\n  \"applications\": {\n    \"($string || $number || $array || $object) && !(debug_meta.** || $frame.filename || $frame.abs_path || $logentry.formatted || $error.value)\": [\n      \"@common:filter\",\n      \"@ip:replace\",\n      \"strip-fields\"\n    ],\n    \"$http.env.REMOTE_ADDR || $user.ip_address || $sdk.client_ip\": [\n      \"@anything:remove\"\n    ],\n    \"*.cookies.sentrysid || *.cookies.sudo || *.cookies.su || *.cookies.session || *.cookies.sessionid || *.cookies.user_session || *.cookies.symfony || *.cookies.phpsessid || *.cookies.fasthttpsessionid || *.cookies.mysession || *.cookies.irissessionid || *.cookies.csrf || *.cookies.xsrf || *.cookies._xsrf || *.cookies._csrf || *.cookies.csrf-token || *.cookies.csrf_token || *.cookies.xsrf-token || *.cookies.xsrf_token || *.cookies.fastcsrf || *.cookies._iris_csrf\": [\n      \"@anything:filter\"\n    ]\n  }\n}"}}
{"run_id":"1683640102-44947000","line":300,"new":{"module_name":"relay_general__pii__convert__tests","snapshot_name":"convert_empty_sensitive_field","metadata":{"source":"relay-general/src/pii/convert.rs","assertion_line":300,"expression":"pii_config"},"snapshot":"{\n  \"applications\": {\n    \"($string || $number || $array || $object) && !(debug_meta.** || $frame.filename || $frame.abs_path || $logentry.formatted || $error.value)\": [\n      \"@common:filter\",\n      \"@ip:replace\"\n    ],\n    \"$http.env.REMOTE_ADDR || $user.ip_address || $sdk.client_ip\": [\n      \"@anything:remove\"\n    ],\n    \"*.cookies.sentrysid || *.cookies.sudo || *.cookies.su || *.cookies.session || *.cookies.__session || *.cookies.sessionid || *.cookies.user_session || *.cookies.symfony || *.cookies.phpsessid || *.cookies.fasthttpsessionid || *.cookies.mysession || *.cookies.irissessionid || *.cookies.csrf || *.cookies.xsrf || *.cookies._xsrf || *.cookies._csrf || *.cookies.csrf-token || *.cookies.csrf_token || *.cookies.xsrf-token || *.cookies.xsrf_token || *.cookies.fastcsrf || *.cookies._iris_csrf\": [\n      \"@anything:filter\"\n    ]\n  }\n}"},"old":{"module_name":"relay_general__pii__convert__tests","metadata":{},"snapshot":"{\n  \"applications\": {\n    \"($string || $number || $array || $object) && !(debug_meta.** || $frame.filename || $frame.abs_path || $logentry.formatted || $error.value)\": [\n      \"@common:filter\",\n      \"@ip:replace\"\n    ],\n    \"$http.env.REMOTE_ADDR || $user.ip_address || $sdk.client_ip\": [\n      \"@anything:remove\"\n    ],\n    \"*.cookies.sentrysid || *.cookies.sudo || *.cookies.su || *.cookies.session || *.cookies.sessionid || *.cookies.user_session || *.cookies.symfony || *.cookies.phpsessid || *.cookies.fasthttpsessionid || *.cookies.mysession || *.cookies.irissessionid || *.cookies.csrf || *.cookies.xsrf || *.cookies._xsrf || *.cookies._csrf || *.cookies.csrf-token || *.cookies.csrf_token || *.cookies.xsrf-token || *.cookies.xsrf_token || *.cookies.fastcsrf || *.cookies._iris_csrf\": [\n      \"@anything:filter\"\n    ]\n  }\n}"}}
{"run_id":"1683640102-44947000","line":391,"new":{"module_name":"relay_general__pii__convert__tests","snapshot_name":"convert_exclude_field","metadata":{"source":"relay-general/src/pii/convert.rs","assertion_line":391,"expression":"pii_config"},"snapshot":"{\n  \"applications\": {\n    \"($string || $number || $array || $object) && !(debug_meta.** || $frame.filename || $frame.abs_path || $logentry.formatted || $error.value) && !foobar\": [\n      \"@common:filter\",\n      \"@ip:replace\"\n    ],\n    \"$http.env.REMOTE_ADDR || $user.ip_address || $sdk.client_ip\": [\n      \"@anything:remove\"\n    ],\n    \"*.cookies.sentrysid || *.cookies.sudo || *.cookies.su || *.cookies.session || *.cookies.__session || *.cookies.sessionid || *.cookies.user_session || *.cookies.symfony || *.cookies.phpsessid || *.cookies.fasthttpsessionid || *.cookies.mysession || *.cookies.irissessionid || *.cookies.csrf || *.cookies.xsrf || *.cookies._xsrf || *.cookies._csrf || *.cookies.csrf-token || *.cookies.csrf_token || *.cookies.xsrf-token || *.cookies.xsrf_token || *.cookies.fastcsrf || *.cookies._iris_csrf\": [\n      \"@anything:filter\"\n    ]\n  }\n}"},"old":{"module_name":"relay_general__pii__convert__tests","metadata":{},"snapshot":"{\n  \"applications\": {\n    \"($string || $number || $array || $object) && !(debug_meta.** || $frame.filename || $frame.abs_path || $logentry.formatted || $error.value) && !foobar\": [\n      \"@common:filter\",\n      \"@ip:replace\"\n    ],\n    \"$http.env.REMOTE_ADDR || $user.ip_address || $sdk.client_ip\": [\n      \"@anything:remove\"\n    ],\n    \"*.cookies.sentrysid || *.cookies.sudo || *.cookies.su || *.cookies.session || *.cookies.sessionid || *.cookies.user_session || *.cookies.symfony || *.cookies.phpsessid || *.cookies.fasthttpsessionid || *.cookies.mysession || *.cookies.irissessionid || *.cookies.csrf || *.cookies.xsrf || *.cookies._xsrf || *.cookies._csrf || *.cookies.csrf-token || *.cookies.csrf_token || *.cookies.xsrf-token || *.cookies.xsrf_token || *.cookies.fastcsrf || *.cookies._iris_csrf\": [\n      \"@anything:filter\"\n    ]\n  }\n}"}}
{"run_id":"1683640102-44947000","line":275,"new":{"module_name":"relay_general__pii__convert__tests","snapshot_name":"convert_default_pii_config","metadata":{"source":"relay-general/src/pii/convert.rs","assertion_line":275,"expression":"simple_enabled_pii_config()"},"snapshot":"{\n  \"applications\": {\n    \"($string || $number || $array || $object) && !(debug_meta.** || $frame.filename || $frame.abs_path || $logentry.formatted || $error.value)\": [\n      \"@common:filter\",\n      \"@ip:replace\"\n    ],\n    \"$http.env.REMOTE_ADDR || $user.ip_address || $sdk.client_ip\": [\n      \"@anything:remove\"\n    ],\n    \"*.cookies.sentrysid || *.cookies.sudo || *.cookies.su || *.cookies.session || *.cookies.__session || *.cookies.sessionid || *.cookies.user_session || *.cookies.symfony || *.cookies.phpsessid || *.cookies.fasthttpsessionid || *.cookies.mysession || *.cookies.irissessionid || *.cookies.csrf || *.cookies.xsrf || *.cookies._xsrf || *.cookies._csrf || *.cookies.csrf-token || *.cookies.csrf_token || *.cookies.xsrf-token || *.cookies.xsrf_token || *.cookies.fastcsrf || *.cookies._iris_csrf\": [\n      \"@anything:filter\"\n    ]\n  }\n}"},"old":{"module_name":"relay_general__pii__convert__tests","metadata":{},"snapshot":"{\n  \"applications\": {\n    \"($string || $number || $array || $object) && !(debug_meta.** || $frame.filename || $frame.abs_path || $logentry.formatted || $error.value)\": [\n      \"@common:filter\",\n      \"@ip:replace\"\n    ],\n    \"$http.env.REMOTE_ADDR || $user.ip_address || $sdk.client_ip\": [\n      \"@anything:remove\"\n    ],\n    \"*.cookies.sentrysid || *.cookies.sudo || *.cookies.su || *.cookies.session || *.cookies.sessionid || *.cookies.user_session || *.cookies.symfony || *.cookies.phpsessid || *.cookies.fasthttpsessionid || *.cookies.mysession || *.cookies.irissessionid || *.cookies.csrf || *.cookies.xsrf || *.cookies._xsrf || *.cookies._csrf || *.cookies.csrf-token || *.cookies.csrf_token || *.cookies.xsrf-token || *.cookies.xsrf_token || *.cookies.fastcsrf || *.cookies._iris_csrf\": [\n      \"@anything:filter\"\n    ]\n  }\n}"}}
{"run_id":"1683640102-44947000","line":325,"new":{"module_name":"relay_general__pii__convert__tests","snapshot_name":"convert_sensitive_fields","metadata":{"source":"relay-general/src/pii/convert.rs","assertion_line":325,"expression":"pii_config"},"snapshot":"{\n  \"rules\": {\n    \"strip-fields\": {\n      \"type\": \"redact_pair\",\n      \"keyPattern\": \"fieldy_field|moar_other_field\",\n      \"redaction\": {\n        \"method\": \"replace\",\n        \"text\": \"[Filtered]\"\n      }\n    }\n  },\n  \"applications\": {\n    \"($string || $number || $array || $object) && !(debug_meta.** || $frame.filename || $frame.abs_path || $logentry.formatted || $error.value)\": [\n      \"@common:filter\",\n      \"@ip:replace\",\n      \"strip-fields\"\n    ],\n    \"$http.env.REMOTE_ADDR || $user.ip_address || $sdk.client_ip\": [\n      \"@anything:remove\"\n    ],\n    \"*.cookies.sentrysid || *.cookies.sudo || *.cookies.su || *.cookies.session || *.cookies.__session || *.cookies.sessionid || *.cookies.user_session || *.cookies.symfony || *.cookies.phpsessid || *.cookies.fasthttpsessionid || *.cookies.mysession || *.cookies.irissessionid || *.cookies.csrf || *.cookies.xsrf || *.cookies._xsrf || *.cookies._csrf || *.cookies.csrf-token || *.cookies.csrf_token || *.cookies.xsrf-token || *.cookies.xsrf_token || *.cookies.fastcsrf || *.cookies._iris_csrf\": [\n      \"@anything:filter\"\n    ]\n  }\n}"},"old":{"module_name":"relay_general__pii__convert__tests","metadata":{},"snapshot":"{\n  \"rules\": {\n    \"strip-fields\": {\n      \"type\": \"redact_pair\",\n      \"keyPattern\": \"fieldy_field|moar_other_field\",\n      \"redaction\": {\n        \"method\": \"replace\",\n        \"text\": \"[Filtered]\"\n      }\n    }\n  },\n  \"applications\": {\n    \"($string || $number || $array || $object) && !(debug_meta.** || $frame.filename || $frame.abs_path || $logentry.formatted || $error.value)\": [\n      \"@common:filter\",\n      \"@ip:replace\",\n      \"strip-fields\"\n    ],\n    \"$http.env.REMOTE_ADDR || $user.ip_address || $sdk.client_ip\": [\n      \"@anything:remove\"\n    ],\n    \"*.cookies.sentrysid || *.cookies.sudo || *.cookies.su || *.cookies.session || *.cookies.sessionid || *.cookies.user_session || *.cookies.symfony || *.cookies.phpsessid || *.cookies.fasthttpsessionid || *.cookies.mysession || *.cookies.irissessionid || *.cookies.csrf || *.cookies.xsrf || *.cookies._xsrf || *.cookies._csrf || *.cookies.csrf-token || *.cookies.csrf_token || *.cookies.xsrf-token || *.cookies.xsrf_token || *.cookies.fastcsrf || *.cookies._iris_csrf\": [\n      \"@anything:filter\"\n    ]\n  }\n}"}}
